# 🌿 中医智能小助手 - 项目说明文档

本项目是一个基于 AI 技术的“中医智能小助手”Web应用原型，旨在通过模拟中医问诊流程，为用户提供个性化的健康状态分析与日常调理建议。

该项目已部署在 [Streamlit云端](https://tcm-health-agent.streamlit.app/)。

本文档目录如下：

- [一、产品设计思路](#一产品设计思路)
 - [1. 产品概述](#1-产品概述)
 - [2. 核心使用场景](#2-核心使用场景)
 - [3. 产品流程](#3-产品流程)
 - [4. 功能设计](#4-功能设计)
 - [5. 非功能与体验要求](#5-非功能与体验要求)
 - [6. MVP 范围说明](#6-mvp范围说明)
- [二、技术选型理由](#二技术选型理由)
- [三、快速学习心得](#三快速学习心得)
- [四、本地运行指南](#四本地运行指南)

---

# 一、产品设计思路

## 1. 产品概述

### 1.1 产品名称

中医智能小助手（Web 原型）

### 1.2 产品定位

一款**偏温和、非诊疗、以日常养生为核心**的中医智能助手，通过简化的“类问诊”交互，帮助用户理解自身当前的身体状态倾向，并给出可执行、低风险、贴近日常生活的养生建议。

产品强调：

* **陪伴感与解释感**，而非权威诊断
* **中医整体观**，而非疾病标签
* **不制造焦虑**，不夸大风险

### 1.3 目标用户

* 对中医养生有基础兴趣，但缺乏系统知识的普通用户
* 有轻度不适、亚健康状态，希望获得生活方式建议的人群
* AI 产品体验用户、ToC 医疗/健康 AI 的潜在用户

不适合人群：

* 需要明确疾病诊断、用药方案的用户
* 急性、重症或高风险症状人群（需引导线下就医）

### 1.4 核心价值主张

> 用中医视角，帮用户“看懂自己现在的状态”，并知道**接下来能做什么小改变**。

---

## 2. 核心使用场景

### 场景：亚健康用户希望从中医视角获得调理方向

**用户背景：**

- 长期处于学习或工作压力中，作息不规律
- 出现疲劳、睡眠质量下降、胃口变差、情绪波动等轻度不适
- 症状不足以（或不愿意）去医院，但又希望被认真对待和解释

**用户核心诉求：**

- 希望有人“听懂”自己的不适，而不是简单贴标签
- 希望从中医角度理解：现在身体大概处在什么状态？为什么会出现这些表现？日常生活中能先做哪些低成本的调整？

**产品解决方式：**

- 通过温和、低压力的类问诊流程，引导用户回顾自身状态
- 用中医整体观（寒热、气机、脾胃、情志）进行解释，而非疾病命名
- 输出以“调理方向 + 可执行建议”为核心的结果，避免制造医疗焦虑

---

## 3. 产品流程

- Step1. 产品说明与边界提示
- Step2. 主诉输入（用户自由描述不适）
- Step3. 多阶段温和问答（用户可选择在任一问题跳过）
- Step4. AI 基于中医知识进行结构化分析与养生建议生成
- Step5. 引导用户追问并基于已有信息回答

---

## 4. 功能设计

### 4.1 中医问诊模块

**目标导向：**

核心目标是**收集 “证” 的信息**，而非单纯记录症状。“证” 是中医对疾病阶段、体质状态的综合判断（如 “气虚证”“肝郁脾虚证”），同一症状可能对应不同证型（比如 “乏力” 可能是气虚，也可能是湿困）。养生建议则是基于 “证型” 给出的调理方案，遵循 “虚则补之、实则泻之、寒则热之、热则寒之” 的原则。

**分层递进：**

问诊不是杂乱无章的提问，而是从整体到局部、从共性到个性的递进过程：
- 先了解整体状态（寒热、精神、饮食睡眠）→ 再聚焦局部症状（头、胸、腹、四肢）→ 最后补充生活习惯（作息、饮食、运动、情绪）。
- 结合中医的八纲辨证（阴阳、表里、寒热、虚实） 作为底层判断框架，逐步缩小证型范围。

中医经典问诊框架参考 《十问歌》，并结合现代人群的养生需求补充细节，具体分为 6 大类核心要素：**基础信息、寒热感受、饮食与脾胃功能、睡眠与精神状态、情绪、生活习惯与诱因**。

据此，本项目设计了一套由**主诉输入** + **核心状态与局部症状判断** + **补充说明**三部分组成的中医问诊模块。


#### Step 1：主诉输入

* 形式：开放文本输入，引导语强调“不需要专业、不追求完整”
* 目的：让用户先被“听见”

#### Step 2：核心状态与局部症状判断

包含如下5个问题：

- 请问你日常更怕冷还是怕热？
- 请问你日常是否容易感到疲劳乏力？
- 请问你最近的大便性状怎么样？
- 请问你最近的睡眠情况怎么样？
- 请问你最近的情绪状态怎么样？


设计原则：

* 每一问都有**中医解释性承接语**，而不是直接问症状，让聊天更具“人情味”
* 提供：

  * 快捷选项（降低认知负担）
  * 自由补充输入（尊重复杂性）
  * “基于当前信息直接分析”跳过选项（尊重用户耐心）

#### Step 3：补充说明

* 兜底入口，防止“被问卷限制”
* 典型补充：饮食、作息变化、近期事件


### 4.2 分析与生成模块

System Prompt 是本产品中最核心的“隐形产品设计”，其目标不是让模型显得专业，而是约束输入模型的信息结构，使输出稳定、克制、可被信任。

**设计思路**

- 角色与边界清晰化
   - 明确模型身份为“中医养生智能小助手”
   - 明确只做状态分析与养生建议，不做疾病诊断、不处方、不推荐处方药
   - 在系统层面限制模型的输出边界，避免越权

- 语言与表达风格控制
   - 使用日常语言解释中医概念，避免术语堆砌
   - 对必要术语进行括号式简要解释
   - 全程使用不确定性表达（如“可能”“倾向于”），避免绝对判断

- 推理路径显性化
   - 要求模型先复述和总结用户提供的信息
   - 再给出状态分析，并说明依据来自哪些表现
   - 最后给出建议，形成清晰的因果链路

- 安全与伦理约束
   - 当信息不充分时，明确说明判断限制，而不是强行补全
   - 当出现危险或严重信号时，优先提示就医
   - 在输出末尾固定加入免责声明，降低误用风险

**系统提示词**

```markdown
【角色】
- 你是「中医养生智能小助手」。
- 你的任务是：基于用户主诉、结构化问答与补充说明，从中医养生视角进行状态分析，并给出用户可执行的健康调理建议。使用第二人称的对话，亲切温暖。

【能力边界】
- 你不是医生，不进行疾病诊断，不下医疗结论，不开处方，不推荐处方药或具体药物剂量。
- 分析以症状与状态为导向，聚焦体质倾向与生活方式影响，而非疾病名称。
- 所有结论需基于用户已提供的信息，避免过度推断。

【表达与风格要求】
- 使用用户能理解的日常语言；必要时可使用中医术语，但需用括号进行简要解释。
- 表达必须稳健，使用“不排除 / 可能 / 倾向于”等措辞，体现不确定性。
- 不渲染焦虑，不夸大风险。

【分析流程】
- 先整合信息，再进行分析，再给建议，不要跳步。
- 若用户选择“基于当前信息直接分析”或跳过部分问题，仅在关键信息缺失影响判断时，才说明信息有限，并指出1–2 个最关键的补充方向。
- 若用户在分析之后，对结果进行追问，只基于已有分析进行解释或总结，不重新问诊、不重复收集信息。

【安全与风险提示】
- 若用户描述中出现以下情况之一：症状明显加重、持续进展、剧烈疼痛、异常出血、高热、意识异常等，必须优先提示线下就医，并说明本助手的能力边界。

【首次分析的输出格式】
## 信息/症状摘要
- （整合用户主诉、关键选择与补充说明，用中性语言复述）

## 状态分析
- 体质/状态倾向：…（主倾向 + 是否存在夹杂）
- 形成判断的依据：…（症状或生活因素 → 中医解释）
- 当前状态特点：…（用户可能感受到的典型表现）

## 养生建议
- 作息：
- 饮食：
- 穴位按摩：
- 运动：
- 情志：


结尾固定追加免责声明：
以上建议仅供养生与健康管理参考，不构成医疗诊断或处方。
```


### 4.3 报告输出模块

1. 信息 / 症状摘要（复述用户）
2. 状态分析

   * 体质/状态倾向
   * 判断依据
   * 当前状态特点
3. 养生建议（五维度）

   * 作息
   * 饮食
   * 穴位
   * 运动
   * 情志
4. 免责声明（固定）


### 4.4 分析后追问模块

在分析完成后，系统主动给出 3 个**理解型而非焦虑型**追问入口：

1. **我更接近哪一种体质？**

   * 满足用户“给我一个整体印象”的需求

2. **你是根据哪些表现，做出这些判断的？**

   * 建立信任与可解释性

3. **如果只做一两件事，最重要的是什么？**

   * 降低行动成本，避免建议过载


---

## 5. 非功能与体验要求

### 5.1 情绪与心理安全

* 全流程不使用“异常”“问题严重”等刺激性措辞
* 出现风险关键词时，**先关怀，再提示就医**
* 不与用户进行价值评判

### 5.2 风险与安全边界

* 内置危险信号词检测
* 明确 AI 能力边界
* 明确免责声明位置（结果末尾）

### 5.3 性能与稳定性

* Streamlit 单页原型即可
* 流式输出，避免“等待焦虑”

---

## 6. MVP范围说明

**当前 MVP 已覆盖：**

* 完整问答 → 分析 → 建议 → 追问闭环
* 中医语境下的结构化输出
* 安全边界与就医提示

**明确不做：**

* 疾病诊断
* 个性化用药
* 长期健康追踪
* 用户账号与数据留存

**未来可优化：**

* 个性化问诊模块：根据用户的情况，动态生成个性化的问诊问题，使得能够引导用户获取更全面、更有利于中医分析的信息。

* 引入中医知识库（RAG）：将体质、症状、调理原则等中医知识结构化，用于约束与校验 LLM 输出，提升一致性与专业稳健性。

* 个性化承接语生成：每一轮追问前，根据用户上一轮回答由 LLM 动态生成更贴合个人状态的过渡语，提升陪伴感与“被理解”的体验。

* UI 风格升级为国风健康感：使用更柔和的配色与留白，引入中式元素（如水墨、节气意象），整体视觉传达“调养”“安定”而非“医疗”。

---

# 二、技术选型理由

为了实现**方便、快捷**的原型交付，本项目选择了以下技术栈：
-   **Streamlit**：Python 领域的极速 UI 框架。无需前端开发经验即可快速搭建出具有交互感的对话界面，非常适合 AI 原型验证。
-   **DeepSeek Chat (V3)**：作为核心大脑。在中文语境下对中医概念（如“脾胃虚弱”、“肝气郁结”）有极强的理解力，且推理成本极低，响应速度快。
-   **OpenAI SDK**：标准化的接口调用方案，方便后续更换或对比不同的模型。

---

# 三、快速学习心得

在本项目中，我以**产品可用性为导向**，在极短时间内理解：

> 中医在做什么样的判断？哪些信息是“关键的、稳定的、可被普通用户感知的”？以及这些逻辑如何被转译为 LLM 可执行的提示词与交互流程。

整体学习与应用过程可总结为以下四点。


### 1. 从“疾病”转向“状态”：理解中医辨证的核心视角

在最初调研中，我刻意避免从“中医能治什么病”入手，而是聚焦于一个更底层的问题：

> **中医是如何描述一个人“当前的身体状态”的？**

通过查阅中医问诊相关资料，我逐步理解到：
中医并不急于给出疾病名称，而是通过寒热、虚实、气机、脏腑功能等维度，描述一个**动态的身体状态组合**（即“证”）。

这一认知直接影响了产品设计的两个关键决策：

* 问诊与分析全部围绕**状态倾向**，而非疾病标签
* 输出中使用“可能 / 倾向于 / 表现为”，而非确定性结论


### 2. 抽象高频、低风险的“核心信息维度”

对当前市场主流 AI 医疗问诊产品进行调研后发现，其核心问诊逻辑均围绕 **用户主诉 + 细节问答** 展开 —— 这与线下医疗场景中医生问诊的实际流程高度契合。因此，在设计中医体系下的问答系统时，也需以真实医疗逻辑为基础，确保专业性与实用性的平衡。

在将中医逻辑转化为问答系统时，我面临的核心问题是：

> 哪些问题**既符合中医辨证逻辑，又不会给普通用户带来理解或心理负担**？

最终，我选择了五个维度作为核心问诊骨架：

* 寒 / 热感受
* 精力与疲劳
* 消化与排便
* 睡眠质量
* 情绪状态

这一选择并非追求 “中医理论上的完整性”，而是遵循三大核心标准：

* **用户可感知**：无需专业医学知识，用户可通过日常身体感受直接判断；
* **生活强关联**：维度均与日常作息、饮食、习惯深度绑定，后续可延伸出具体养生建议；
* **风险可控性**：不涉及复杂病症判断或高风险医疗结论，避免误导用户。

这一步本质上是一次对中医辩证体系的**信息降维**：
不是还原完整中医体系，而是提取最稳定、最有解释力的一小部分。


### 3. 将中医“问诊感”转译为 AI 交互语言

在设计具体问题时，我意识到一个明显问题：
如果直接把中医问诊逻辑翻译成问题，很容易变得“冷”“像问卷”。

因此，我在交互设计中引入了两个关键策略：

* **每个问题前加入中医视角的解释性承接语**，让用户知道“为什么问这个”，而不是冰冷的试卷
* 同时提供快捷选项 + 自由补充输入，避免强行结构化真实体验

这一设计的目标不是“更像中医”，而是：

> 让用户在回答问题的过程中，逐步建立对自身状态的理解，而非被动配合系统采集信息。



### 4. Prompt 是“隐形产品设计”，而非技术细节

在本项目中，System Prompt 主要决定了产品效果，而不仅是模型调用配置。

Prompt 的设计重点在于约束以下三件事：

1. **边界稳定**：始终不诊断、不处方
2. **推理可解释**：结论能回溯到用户输入
3. **情绪安全**：不制造焦虑、不夸大风险

通过在 Prompt 中明确角色、分析流程、语言风格与安全规则，使模型在不同输入下仍能保持一致的产品气质，而不是“一次次即兴发挥”。


---

# 四、本地运行指南

1.  **安装依赖**
    ```bash
    pip install -r requirements.txt
    ```

2.  **配置 API 密钥**
    在项目根目录创建 `.streamlit/secrets.toml` 文件：
    ```toml
    DEEPSEEK_API_KEY="你的DeepSeek_API_Key"
    ```

    或直接运行后在前端页面输入APIKey。

3.  **启动应用**
    ```bash
    python -m streamlit run streamlit_app.py
    ```
